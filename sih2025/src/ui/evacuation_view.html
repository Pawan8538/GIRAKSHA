<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>GeoGuard â€” Emergency Evacuation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">

    <style>
        :root {
            --emergency-red: #dc2626;
            --emergency-dark: #450a0a;
            --bg-color: #000000;
            --text-color: #ffffff;
            --safe-green: #16a34a;
            --warning-yellow: #facc15;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* Header */
        .header {
            background: var(--emergency-red);
            padding: 16px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(220, 38, 38, 0.5);
            z-index: 1000;
            animation: pulse-header 2s infinite;
        }

        @keyframes pulse-header {
            0% {
                background-color: #dc2626;
            }

            50% {
                background-color: #b91c1c;
            }

            100% {
                background-color: #dc2626;
            }
        }

        .header h1 {
            margin: 0;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: 1.5rem;
        }

        .header p {
            margin: 4px 0 0;
            font-weight: 600;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Main Content */
        .main-container {
            flex: 1;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        #map {
            flex: 1;
            width: 100%;
            z-index: 1;
        }

        /* Status Overlay */
        .status-overlay {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
            padding: 12px 24px;
            border-radius: 50px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 1000;
            display: flex;
            gap: 24px;
            align-items: center;
        }

        .status-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .status-label {
            font-size: 0.7rem;
            color: #a0a0a0;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .status-value {
            font-weight: 700;
            font-size: 1.1rem;
        }

        /* Bottom Action Bar */
        .action-bar {
            background: #1a1a1a;
            padding: 20px;
            display: flex;
            gap: 16px;
            z-index: 1000;
            border-top: 1px solid #333;
        }

        .btn {
            flex: 1;
            padding: 16px;
            border-radius: 12px;
            border: none;
            font-weight: 700;
            font-size: 1rem;
            text-transform: uppercase;
            cursor: pointer;
            transition: transform 0.1s;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-sos {
            background: var(--emergency-red);
            color: white;
            flex: 0 0 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            box-shadow: 0 0 15px rgba(220, 38, 38, 0.4);
        }

        .btn-safe {
            background: var(--safe-green);
            color: white;
        }

        .btn-contacts {
            background: #333;
            color: white;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #1a1a1a;
            padding: 24px;
            border-radius: 16px;
            width: 100%;
            max-width: 400px;
            text-align: center;
            border: 1px solid #333;
        }

        .modal-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .contact-list {
            text-align: left;
            margin-bottom: 24px;
        }

        .contact-item {
            padding: 12px;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: space-between;
        }

        /* Leaflet Customization */
        .leaflet-bar {
            border: none !important;
        }

        .leaflet-bar a {
            background-color: #1a1a1a !important;
            color: white !important;
            border-bottom: 1px solid #333 !important;
        }
    </style>
</head>

<body>

    <div class="header">
        <h1>Evacuation Alert</h1>
        <p>Proceed to Assembly Point B immediately</p>
    </div>

    <div class="main-container">
        <div id="map"></div>

        <div class="status-overlay">
            <div class="status-item">
                <span class="status-label">Status</span>
                <span class="status-value" style="color: var(--warning-yellow)">Evacuating</span>
            </div>
            <div class="status-item">
                <span class="status-label">Distance</span>
                <span class="status-value">450m</span>
            </div>
            <div class="status-item">
                <span class="status-label">ETA</span>
                <span class="status-value">5 min</span>
            </div>
        </div>
    </div>

    <div class="action-bar">
        <button class="btn btn-sos" onclick="triggerSOS()">SOS</button>
        <button class="btn btn-contacts" onclick="toggleContacts()">Contacts</button>
        <button class="btn btn-safe" onclick="markSafe()">I am Safe</button>
    </div>

    <!-- Contacts Modal -->
    <div id="contactsModal" class="modal">
        <div class="modal-content">
            <div class="modal-title">Emergency Contacts</div>
            <div class="contact-list">
                <div class="contact-item">
                    <span>Control Room</span>
                    <a href="tel:101" style="color: var(--accent-color); text-decoration: none;">Call</a>
                </div>
                <div class="contact-item">
                    <span>Site Manager</span>
                    <a href="tel:1234567890" style="color: var(--accent-color); text-decoration: none;">Call</a>
                </div>
                <div class="contact-item">
                    <span>Medical Unit</span>
                    <a href="tel:108" style="color: var(--accent-color); text-decoration: none;">Call</a>
                </div>
            </div>
            <button class="btn btn-contacts" style="width:100%" onclick="toggleContacts()">Close</button>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>

    <script>
        // Map Init
        const map = L.map('map', {
            zoomControl: false
        }).setView([15.15, 76.92], 15);

        L.control.zoom({ position: 'bottomright' }).addTo(map);

        // Dark Map Layer
        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; OpenStreetMap contributors',
            maxZoom: 20
        }).addTo(map);

        // Mock Data
        const userLocation = [15.152, 76.921];
        const assemblyPoint = [15.148, 76.925];
        const dangerZone = [
            [15.155, 76.918],
            [15.155, 76.922],
            [15.151, 76.922],
            [15.151, 76.918]
        ];

        // User Marker
        const userIcon = L.divIcon({
            className: 'user-marker',
            html: `<div style="width: 16px; height: 16px; background: #3b82f6; border: 3px solid white; border-radius: 50%; box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.4);"></div>`,
            iconSize: [24, 24]
        });
        L.marker(userLocation, { icon: userIcon }).addTo(map).bindPopup("You are here");

        // Assembly Point
        const assemblyIcon = L.divIcon({
            className: 'assembly-marker',
            html: `<div style="background: #16a34a; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold; font-size: 12px; white-space: nowrap; border: 2px solid white;">ASSEMBLY POINT B</div>`,
            iconSize: [120, 24],
            iconAnchor: [60, 30]
        });
        L.marker(assemblyPoint, { icon: assemblyIcon }).addTo(map);

        // Danger Zone
        L.polygon(dangerZone, {
            color: '#dc2626',
            fillColor: '#dc2626',
            fillOpacity: 0.3,
            weight: 2,
            dashArray: '5, 10'
        }).addTo(map).bindPopup("DANGER ZONE - ROCKFALL RISK");

        // Route (Mocked Polyline)
        const routePoints = [
            userLocation,
            [15.151, 76.923], // waypoint
            assemblyPoint
        ];
        L.polyline(routePoints, {
            color: '#16a34a',
            weight: 4,
            dashArray: '10, 10',
            opacity: 0.8
        }).addTo(map);

        // Fit bounds
        const bounds = L.latLngBounds([userLocation, assemblyPoint]);
        map.fitBounds(bounds, { padding: [50, 50] });

        // Interactions
        function triggerSOS() {
            if (confirm("TRIGGER SOS BEACON? This will alert all nearby units.")) {
                alert("SOS SIGNAL SENT! Help is on the way. Stay put if unsafe to move.");
            }
        }

        function markSafe() {
            alert("Status updated: SAFE. Proceed to assembly point.");
        }

        function toggleContacts() {
            const modal = document.getElementById('contactsModal');
            modal.classList.toggle('active');
        }

    </script>
</body>

</html>